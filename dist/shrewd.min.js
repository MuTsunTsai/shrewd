/**
 * shrewd v0.0.11
 * (c) 2019-2021 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,(function(){"use strict";var t;!function(t){t.array=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0},t.unorderedArray=function(t,e){if(!t!=!e)return!1;if(t==e)return!0;if(t.length!=e.length)return!1;for(let s of t)if(!e.includes(s))return!1;return!0}}(t||(t={}));class e{constructor(){this.t=new Set,this.i=e.h++}static o(t){return!(!G.u&&t.l)||(G.$&&!G.p(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),r.g.debug,!1):!(!G.$&&G.m)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty."),r.g.debug,!1))}static v(t){r.g.hook.write(t.i);for(let e of t.t)r.g.debug?e.S(t):e.S()}_(t){this.t.add(t)}j(t){this.t.delete(t)}get l(){return this.t.size>0}get k(){return this.t.values()}}e.h=0;class s{read(t){return!1}write(t){}gc(){return[]}sub(t){return!1}}class i{constructor(t){if(this.O=new Set,this.C=new Set,this.R=t||"undefined"!=typeof window&&window.Vue,!this.R)throw new Error("Global Vue not found; you need to pass a Vue constructor to VueHook.");this.P=new this.R({data:{shrewd:{}}})}read(t){let e=this.P.shrewd[t];return G.m||e||(this.R.set(this.P.shrewd,t,{}),e=this.P.shrewd[t]),e&&e.__ob__.dep.subs.length>0}write(t){r.g.autoCommit||G.m?this.R.set(this.P.shrewd,t,{}):this.O.add(t)}precommit(){for(let t of this.O)this.R.set(this.P.shrewd,t,{});this.O.clear()}gc(){let t=[];for(let e in this.P.shrewd){let s=Number(e);r.g.autoCommit||this.C.has(s)?0==this.P.shrewd[e].__ob__.dep.subs.length&&(r.g.autoCommit||this.C.delete(s),this.R.delete(this.P.shrewd,e),t.push(Number(e))):this.C.add(s)}return t}sub(t){return t in this.P.shrewd&&this.P.shrewd[t].__ob__.dep.subs.length>0}}class r{static A(){r.g.hook.precommit&&r.g.hook.precommit(),A.M(),a.M(),r.g.debug&&d.G(),M.M(),r.g.hook.postcommit&&r.g.hook.postcommit()}}r.g={hook:new s,autoCommit:!0,debug:!1};class n{static get(t){if(c.T(t,T))return t[T];{let e=[];return c.D(t,T,e),e}}static q(t,e,s,i){if(void 0===e)return"function"==typeof t?n.V(t):(e,s,i)=>n.q(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return n.W(C,t,e,void 0,i);if(r.get&&!r.set)return n.W(O,t,e,r,i);if("function"==typeof r.value)return n.W(R,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. Decorated member must be one of the following: a field, a readonly get accessor, or a method.`),r.g.debug}static V(t){var e=new Proxy(t,n.H);return n.F.add(e),e}static W(t,e,s,i,r){var h=new t(e,s,i,r);return n.get(e).push(h.K),h.N()}}n.F=new WeakSet,n.H={construct(t,e,s){n.F.has(s)||console.warn(`Class [${s.name}] is derived form @shrewd class [${t.name}], but it is not decorated with @shrewd.`),G.I({u:!0,m:!1,B:null}),d.J.push(`construct ${t.name}`);try{let i=Reflect.construct(t,e,s);return i.constructor==t&&new o(i),n.L.has(i)&&(n.L.delete(i),l.U(i)),i}finally{d.J.pop(),G.X()}}},n.L=new Set;const h=Symbol("ShrewdObject");class o{constructor(t){this.Y=!1,this.Z=new Map,this.tt=c.D(t,h,this);let e=Object.getPrototypeOf(this.tt);for(;e;){if(c.T(e,T)){let t=e[T];for(let e of t){let t=new e.et(this.tt,e);this.Z.has(t.st)?t.it():this.Z.set(t.st,t)}}e=Object.getPrototypeOf(e)}for(let t of this.Z.values())l.rt(t)}it(){if(!this.Y){for(let t of this.Z.values())t.it();this.Y=!0}}nt(t){return t?this.Z.get(t):this.Z.values()}get ht(){let t=[];for(let e of this.Z.values())e instanceof S&&t.push(e);return t}}class c{static T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static D(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class u{get(t,e,s){let i=t[$],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.ot.bind({ct:e,B:t,ut:r.bind(t),lt:i,at:s})),"size"==e&&d.ft(t[$]),r}ot(...t){switch(this.ct){case"clear":return void(d.o(this.lt)&&this.B.size>0&&(this.B.clear(),e.v(this.lt)));case"delete":return void(d.o(this.lt)&&this.B.has(t[0])&&(this.B.delete(t[0]),e.v(this.lt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":d.ft(this.lt);default:return this.ut(...t)}}}class l{static rt(t){l.O.add(t)}static M(){if(!l.dt){l.dt=!0;for(let t of l.O)l.O.delete(t),t.U();l.dt=!1}}static U(t){if(t[h]){if(!l.dt){l.dt=!0;for(let e of t[h].nt())l.O.delete(e),e.U();l.dt=!1}}else n.L.add(t)}}l.O=new Set,l.dt=!1;class a{static M(){for(let t of a.O)t.it();a.O.clear()}static it(t,e=!1){if(c.T(t,h)){let s=t[h];e?a.O.add(s):s.it()}}}var f;a.O=new Set,function(t){t[t.$t=0]="$outdated",t[t.gt=1]="$updated",t[t.bt=2]="$pending"}(f||(f={}));class d extends e{constructor(t){super(),this.wt=new Set,this.yt=!1,this.vt=f.$t,this.Y=!1,this.trigger=new Set,d.St.set(this.i,this),this._t=t}static jt(){for(let t of d.xt)t.vt==f.bt&&t.kt&&(t.Ot(),d.xt.delete(t))}static G(){for(let t of d.Ct)t.trigger.clear();d.Ct.clear()}static Rt(t){let e=[t._t];for(;t.trigger.size;){let s=t.trigger.values().next().value;if(!(s instanceof d))break;let i=s._t;s instanceof g&&(i+="("+g.Pt(s)+")"),e.push(i),t=s}console.log(e)}static ft(t){if(t instanceof d&&t.Y)return;r.g.hook.read(t.i)&&t instanceof d&&t.At();let e=G.B;e&&e!=t&&!e.Y&&e.wt.add(t)}static Mt(t){if(M.Gt(t)&&!t.Y&&!(t.Tt=t.Dt()))for(let e of t.wt)e instanceof d&&d.Mt(e)}static qt(t,e=!1){t.zt(e)}get Vt(){return!!this.yt}zt(t){if(!t||(this.Wt(),!this.Y)){G.I({u:!1,B:this}),this.yt=!0,A.Et(this);try{let t=new Set(this.wt);this.Ht(),this.Ft();try{let t=this.Kt();this.Nt(t)}finally{this.It()}if(this.Ot(),!this.Y)for(let e of this.wt)t.delete(e),e._(this),this.kt&&e instanceof d&&e.At();for(let e of t)M.rt(e)}finally{this.yt=!1,G.X()}}}S(t){this.Bt(),this.Jt(t),this.kt&&A.rt(this)}it(){this.Y||(A.Et(this),d.St.delete(this.i),d.xt.delete(this),this.Y=!0,this.Lt())}Lt(){this.Ht();for(let t of this.k)t.wt.delete(this),this.j(t);this.Ot(),this.yt=!1}Bt(){if(this.vt==f.gt){this.vt=f.bt,d.xt.add(this);for(let t of this.k)t.Bt()}}Qt(){if(this.yt&&this.Ut(),this.vt!=f.gt){d.J.push(this);try{this.Wt(),this.vt==f.$t?d.qt(this):(d.xt.delete(this),this.Ot())}finally{d.J.pop()}}}Wt(){for(let t of this.wt)if(t instanceof d){if(t.yt)return d.qt(this);if(t.vt!=f.gt)return t.Qt()}}Ut(){r.g.debug;let t=d.J.indexOf(this),e=[this,...d.J.slice(t+1)];e.forEach((t=>t instanceof d&&t.it())),e.push(this);let s=e.map((t=>"string"==typeof t?t:t._t)).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated.")}Ot(){this.vt=f.gt}Jt(t){t&&(d.Ct.add(this),this.trigger.add(t)),this.vt=f.$t}get Xt(){return this.vt}get kt(){return this.Tt=null!=this.Tt?this.Tt:this.Dt()}Dt(){if(r.g.hook.sub(this.i))return!0;for(let t of this.k)if(t.kt)return!0;return!1}At(){if(!this.kt){this.Tt=!0;for(let t of this.wt)t instanceof d&&t.At()}}Ft(){}Nt(t){}It(){}Ht(){for(let t of this.wt)t.j(this);this.wt.clear()}get Yt(){return this.wt.size>0}get Zt(){return this.Y}}d.xt=new Set,d.Ct=new Set,d.St=new Map,d.J=[];const $=Symbol("Observable Helper");class p extends e{constructor(t,e){super(),this.te=c.D(t,$,this),this.ee=new Proxy(t,e),p.se.set(t,this.ee)}static ie(t){if(null==t||"object"!=typeof t)return t;if(p.se.has(t))return p.se.get(t);if(!p.re(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new j(t).ne;break;case Set.prototype:t=new y(t).ne;break;case Map.prototype:t=new m(t).ne;break;case Object.prototype:t=new w(t).ne}return t}static he(t){p.re(t)&&(t=t[$].te),p.se.has(t)&&p.se.delete(t)}static re(t){return null!=t&&"object"==typeof t&&c.T(t,$)}get ne(){return this.ee}}p.se=new WeakMap;class g extends d{constructor(t,e){super(e.oe+"."+e.ce.toString()),this.ue=e,this.le=Object.assign(this.ae,e.g),this.tt=t}static Pt(t){return t.tt.constructor.name}get st(){return this.ue.oe+"."+this.ue.ce.toString()}U(){this.Qt()}get ae(){return{}}Dt(){return!!this.le.active||super.Dt()}fe(){return this.Zt?this.de():(d.ft(this),this.$e())}}class b{has(t,e){return d.ft(t[$]),Reflect.has(t,e)}get(t,e,s){return d.ft(t[$]),Reflect.get(t,e,s)}set(t,s,i,r){let n=t[$];if(e.o(n)){return i!==Reflect.get(t,s,r)&&(Reflect.set(t,s,p.ie(i),r),e.v(n)),!0}return!0}deleteProperty(t,s){let i=t[$];if(e.o(i)){let r=Reflect.deleteProperty(t,s);return r&&e.v(i),r}return!0}}class w extends p{constructor(t){for(let e in t)t[e]=p.ie(t[e]);super(t,w.pe)}get ge(){let t=[];for(let e in this.te){let s=this.te[e];"object"==typeof s&&t.push(s)}return t}}w.pe=new b;class y extends p{constructor(t){for(let e of t)t.delete(e),t.add(p.ie(e));super(t,y.pe)}get ge(){let t=[];for(let e of this.te)"object"==typeof e&&t.push(e);return t}}y.pe=new class extends u{ot(...t){return"add"==this.ct?(d.o(this.lt)&&!this.B.has(t[0])&&(this.B.add(p.ie(t[0])),e.v(this.lt)),this.at):super.ot.apply(this,t)}};class m extends p{constructor(t){for(let[e,s]of t)t.set(e,p.ie(s));super(t,m.pe)}get ge(){let t=[];for(let[e,s]of this.te)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}m.pe=new class extends u{ot(...t){return"set"==this.ct?(d.o(this.lt)&&!this.B.has(t[0])&&(this.B.set(t[0],p.ie(t[1])),e.v(this.lt)),this.at):super.ot.apply(this,t)}};class v extends g{constructor(t,e){var s,i;super(t,e),this.be=e.ut,this.le.active&&this.S(),null!==(s=(i=this.le).comparer)&&void 0!==s||(i.comparer=(t,e)=>t===e)}get Kt(){return this.be.bind(this.tt)}Nt(t){this.le.comparer.apply(this.tt,[this.we,t,this])||(this.we=t,e.v(this)),this.Yt||this.it()}$e(){return this.Qt(),this.Yt||this.it(),this.we}de(){return this.we}Lt(){p.he(this.we),super.Lt()}}class S extends g{constructor(t,e){super(t,e),this.ye=!1,this.me=this.ve=t[e.ce],Object.defineProperty(t,e.ce,S.Se(e.ce)),this.le.renderer||this.Ot()}static Se(t){return S._e[t]=S._e[t]||{get(){return this[h].nt(t).fe()},set(e){this[h].nt(t).je(e)}}}static xe(t){if(null!=t&&"object"==typeof t)if(p.re(t)){if(!G.p(t[$])){G.xe(t[$]);for(let e of t[$].ge)S.xe(e)}}else if(c.T(t,h))for(let e of t[h].ht)G.p(e)||(G.xe(e),S.xe(e.me))}get st(){return this.ue.ce.toString()}U(){this.ye||(this.ke(),this.le.renderer?this.Qt():this.me=this.ve,this.ye=!0)}Jt(t){this.le.renderer&&super.Jt(t)}ke(){var t,e;null===(e=null===(t=this.le.validator)||void 0===t?void 0:t.apply(this.tt,[this.ve]))||void 0===e||e||(this.ve=void 0),this.ve=p.ie(this.ve)}$e(){return this.ye?(this.le.renderer&&this.Qt(),this.me):(this.ke(),this.ve)}de(){return this.me}je(t){var s,i;if(this.Zt)this.me=t;else if(e.o(this)&&t!==this.ve){if(null!==(i=null===(s=this.le.validator)||void 0===s?void 0:s.apply(this.tt,[t]))&&void 0!==i&&!i)return r.g.hook.write(this.i);if(this.ve=p.ie(t),this.le.renderer){this.Ft();try{this.Nt(this.Kt())}finally{this.It()}}else this.v(this.ve)}}Ft(){G.I({$:!0,Oe:new Set}),S.xe(this.ve)}get Kt(){return this.le.renderer.bind(this.tt,this.ve)}Nt(t){t!==this.me&&this.v(p.ie(t))}It(){G.X()}v(t){this.me=t,e.v(this)}Lt(){p.he(this.ve),p.he(this.me),delete this.ve,delete this.le,super.Lt()}}S._e={};class _ extends g{constructor(t,e){super(t,e),this.ot=e.ut}get ae(){return{active:!0}}get Kt(){return this.ot.bind(this.tt)}$e(){return()=>(this.Qt(),this.Ce)}de(){return()=>this.Ce}Nt(t){this.Ce=t,e.v(this)}Lt(){p.he(this.Ce),super.Lt()}}class j extends p{constructor(t){for(let e in t)t[e]=p.ie(t[e]);super(t,j.pe)}get ge(){let t=[];for(let e of this.te)"object"==typeof e&&t.push(e);return this.te}}var x;j.pe=new class extends b{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&d.ft(t[$]),Reflect.get(t,e,s)}},function(e){e.shrewd=n.q,e.symbol=h,e.commit=r.A,e.terminate=a.it,e.initialize=l.U,e.hook={default:s,vue:i},e.option=r.g,e.comparer=t,e.debug={trigger(t,e){if(c.T(t,h)){let s=t[h].nt(e);s?d.Rt(s):console.log("Member not found")}else t instanceof d&&d.Rt(t)}}}(x||(x={})),"undefined"!=typeof window&&window.Vue&&(r.g.hook=new i);class k{constructor(t,e,s,i){this.Re=t,this.Pe=e,this.ue=s,this.Ae=i}get _t(){return this.Re.constructor.name+"."+this.Pe.toString()}get K(){return{ce:this.Pe.toString(),oe:this.Re.constructor.name,et:this.Me,ut:this.ot,g:this.Ae}}get ot(){}N(){}}class O extends k{get Me(){return v}get ot(){return this.ue.get}N(){let t=this._t,e=this.ot;return this.ue.get=function(){if(c.T(this,h)){return this[h].nt(t).fe()}return e.apply(this)},this.ue}}class C extends k{get Me(){return S}}class R extends k{get Me(){return _}get ot(){return this.ue.value}N(){let t=this._t,e=this.ot;return delete this.ue.value,delete this.ue.writable,this.ue.get=function(){if(c.T(this,h)){return this[h].nt(t).fe()}return e.bind(this)},this.ue}}class P{static async Ge(){await r.A(),P.Te=!1}static N(){r.g.autoCommit&&!P.Te&&(P.Te=!0,Promise.resolve().then(P.Ge))}}P.Te=!1;class A{static M(){for(G.I({m:!0});A.O.size>0;)for(let t of A.O)d.qt(t,!0);d.jt(),G.X()}static Et(t){A.O.delete(t)}static rt(t){t.Vt||A.O.add(t),P.N()}}A.O=new Set;class M{static rt(t){t instanceof d&&M.O.add(t)}static M(){for(let t of M.O)d.Mt(t);M.O.clear();for(let t of r.g.hook.gc()){let e=d.St.get(t);e&&d.Mt(e)}M.De.clear()}static Gt(t){return!M.De.has(t)&&(M.De.add(t),!0)}}M.O=new Set,M.De=new Set;class G{static I(t){G.qe.push(G.vt),G.vt=Object.assign({},G.vt,t)}static X(){G.vt=G.qe.pop(),0==G.qe.length&&l.M()}static get m(){return G.vt.m}static get u(){return G.vt.u}static get $(){return G.vt.$}static get B(){return G.vt.B}static p(t){return G.vt.Oe.has(t)}static xe(t){G.vt.Oe.add(t)}}G.vt={m:!1,u:!1,$:!1,B:null,Oe:new Set},G.qe=[],G.ze=null;const T=Symbol("Shrewd Decorators");return x}));
//# sourceMappingURL=shrewd.min.js.map
