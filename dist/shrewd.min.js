/**
 * shrewd v0.0.0-beta.12
 * (c) 2019-2020 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,function(){"use strict";class t{constructor(t,e,s,i){this.t=t,this.s=e,this.i=s,this.o=i}get h(){return this.t.constructor.name+"."+this.s.toString()}}class e{constructor(){this.u=new Set,this.l=e.$++}static p(t){return!(!k.g&&t.m)||(k.j&&!k.v(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),r.S.debug,!1):!(!k.j&&k.O)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty. For constructing new Shrewd objects, use Shrewd.construct() method."),r.S.debug,!1))}static _(t){r.S.hook.write(t.l);for(let e of t.u)e.k()}R(t){this.u.add(t)}C(t){this.u.delete(t)}get m(){return this.u.size>0}get P(){return this.u.values()}}e.$=0;class s{read(t){}write(t){}gc(){}sub(t){return!1}}class i{constructor(){this.A=new Vue({data:{shrewd:{}}})}read(t){this.A.shrewd[t]}write(t){Vue.set(this.A.shrewd,t,{})}gc(){for(let t in this.A.shrewd)0==this.A.shrewd[t].G.dep.subs.length&&Vue.delete(this.A.shrewd,t)}sub(t){return t in this.A.shrewd&&this.A.shrewd[t].G.dep.subs.length>0}}class r{static D(){k.M({O:!0});try{for(let t of r.F)f.T(t)}finally{for(let t of r.V)t.W();r.V.clear(),f.q(),r.F.clear(),k.H();for(let t of r.I)t.B();r.I.clear(),r.S.hook.gc()}}static J(t){r.V.add(t)}static K(){r.D(),r.L=!1}static N(t){r.F.delete(t)}static U(t){if(t.X||r.F.add(t),r.S.autoCommit&&!r.L){Promise.resolve().then(r.K),r.L=!0}}static Y(t,...e){k.M({g:!0,O:!1,Z:null}),f.tt.push("construct "+t.name);try{return new t(...e)}finally{f.tt.pop(),k.H()}}static B(t,e=!1){if(c.et(t,o)){let s=t[o];e?r.I.add(s):s.B()}}}r.S={hook:new s,autoCommit:!0,debug:!0},r.F=new Set,r.I=new Set,r.V=new Set,r.L=!1;class n{static get(t){if(c.et(t,R))return t[R];{let e=[];return c.st(t,R,e),e}}static it(t,e,s,i){if(void 0===e)return(e,s,i)=>n.it(e,s,i,t);if("string"==typeof e){let r=s||Object.getOwnPropertyDescriptor(t,e);if(!r)return n.rt(a,t,e,void 0,i);if(r.get&&!r.set)return n.rt(O,t,e,r,i);if("function"==typeof r.value)return n.rt(_,t,e,r,i)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. `+"Decorated member must be one of the following: a field, a readonly get accessor, or a method."),r.S.debug}static rt(t,e,s,i,r){var o=new t(e,s,i,r);if(!o.nt||o.nt())return n.get(e).push(o.ot),o.ht()}}const o=Symbol("ShrewdObject");class h{constructor(t){this.ct=!1,this.ut=new Map,this.at=c.st(t,o,this);let e=Object.getPrototypeOf(this.at);for(;e;){if(c.et(e,R)){let t=e[R];for(let e of t)this.rt(e)}e=Object.getPrototypeOf(e)}}static get(t){return c.et(t,o)?t[o]:new h(t)}rt(t){this.ut.set(t.lt,new t.ft(this.at,t))}B(){if(!this.ct){for(let t of this.ut.values())t.B();this.ct=!0}}dt(t){return this.ut.get(t)}get $t(){let t=[];for(let e of this.ut.values())e instanceof j&&t.push(e);return t}}class c{static et(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static st(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class u{get(t,e,s){let i=t[d],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.pt.bind({bt:e,Z:t,gt:r.bind(t),yt:i,wt:s})),"size"==e&&f.jt(t[d]),r}pt(...t){switch(this.bt){case"clear":return void(f.p(this.yt)&&this.Z.size>0&&(this.Z.clear(),e._(this.yt)));case"delete":return void(f.p(this.yt)&&this.Z.has(t[0])&&(this.Z.delete(t[0]),e._(this.yt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":f.jt(this.yt);default:return this.gt(...t)}}}class a extends t{precondition(){return!Object.getOwnPropertyDescriptor(this.t,this.s)||(console.warn(`Setup error at ${this.t.constructor.name}[${this.s.toString()}]. `+"Decorated property is not a field."),r.S.debug,!1)}get ot(){return{lt:this.s,vt:this.h,ft:j,S:this.o}}ht(){var t=this.t,e=this.s;Object.defineProperty(t,e,{get(){return h.get(this),this[e]},set(t){h.get(this),this[e]=t}})}}var l;!function(t){t[t.St=0]="$outdated",t[t.xt=1]="$updated",t[t.Ot=2]="$pending"}(l||(l={}));class f extends e{constructor(t){super(),this._t=new Set,this.kt=!1,this.Rt=l.St,this.ct=!1,this.h=t}static q(){for(let t of f.Ct)t.Rt==l.Ot&&t.Pt&&(t.At(),f.Ct.delete(t))}static jt(t){if(t instanceof f&&t.ct)return;r.S.hook.read(t.l);let e=k.Z;e&&e!=t&&!e.ct&&e._t.add(t)}static Gt(t){if(t instanceof f&&!t.ct&&(t.Dt=t.checkActive(),!t.Pt)){let e=new Set(t._t);r.N(t);for(let t of e)f.Gt(t)}}static T(t){k.M({g:!1,Z:t}),t.kt=!0,r.N(t);try{let e=new Set(t._t);t.Mt();let s=t.T();if(t.At(),!t.ct)for(let s of t._t)e.delete(s),s.R(t),t.Pt&&s instanceof f&&s.activate();for(let t of e)f.Gt(t);return s}finally{t.kt=!1,k.H()}}get X(){return this.kt}k(){this.Ft(),this.Tt(),this.Pt&&r.U(this)}B(){this.ct||(r.N(this),f.Ct.delete(this),this.ct=!0,this.Vt())}Vt(){this.Mt();for(let t of this.P)t._t.delete(this),this.C(t);this.At(),this.kt=!1}Ft(){if(this.Rt==l.xt){this.Rt=l.Ot,f.Ct.add(this);for(let t of this.P)t.Ft()}}Wt(t=!1){if(this.kt&&this.qt(),this.Rt!=l.xt){f.tt.push(this);try{for(let t of this._t)if(t instanceof f){if(t.kt){f.T(this);break}t.Rt!=l.xt&&t.Wt()}this.Rt==l.St||t?f.T(this):(f.Ct.delete(this),this.At())}finally{f.tt.pop()}}}qt(){let t=f.tt.indexOf(this),e=[this,...f.tt.slice(t+1)];e.forEach(t=>t instanceof f&&t.B()),e.push(this);let s=e.map(t=>"string"==typeof t?t:t.h).join(" => ");console.warn("Cyclic dependency detected: "+s+"\nAll these reactions will be terminated."),r.S.debug}At(){this.Rt=l.xt}Tt(){this.Rt=l.St}get zt(){return this.Rt}get Pt(){return this.Dt=null!=this.Dt?this.Dt:this.checkActive()}checkActive(){if(r.S.hook.sub(this.l))return!0;for(let t of this.P)if(t.Pt)return!0;return!1}activate(){if(!this.Pt){this.Dt=!0;for(let t of this._t)t instanceof f&&t.activate()}}Mt(){for(let t of this._t)t.C(this);this._t.clear()}get Et(){return this.ct}}f.Ct=new Set,f.tt=[];const d=Symbol("Observable Helper");class $ extends e{constructor(t,e){super(),this.Ht=c.st(t,d,this),this.It=new Proxy(t,e),$.Bt.set(t,this.It)}static Jt(t){if(null==t||"object"!=typeof t)return t;if($.Bt.has(t))return $.Bt.get(t);if(!$.Kt(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new S(t).Lt;break;case Set.prototype:t=new y(t).Lt;break;case Map.prototype:t=new m(t).Lt;break;case Object.prototype:t=new g(t).Lt}return t}static Kt(t){return null!=t&&"object"==typeof t&&c.et(t,d)}get Lt(){return this.It}}$.Bt=new WeakMap;class p extends f{constructor(t,e){super(e.vt),this.Nt=!1,this.Qt=Object.assign(this.Ut,e.S),this.at=t,r.J(this)}W(){this.Nt=!0}get Ut(){return{}}checkActive(){return!!this.Qt.active||super.checkActive()}Xt(){return this.Et?this.Yt():(f.jt(this),k.O||this.Nt?this.Zt():this.te())}}class b{has(t,e){return f.jt(t[d]),Reflect.has(t,e)}get(t,e,s){return f.jt(t[d]),Reflect.get(t,e,s)}set(t,s,i,r){let n=t[d];if(e.p(n)){return i!==Reflect.get(t,s,r)&&(Reflect.set(t,s,$.Jt(i),r),e._(n)),!0}return!0}deleteProperty(t,s){let i=t[d];if(e.p(i)){let r=Reflect.deleteProperty(t,s);return r&&e._(i),r}return!0}}class g extends ${constructor(t){for(let e in t)t[e]=$.Jt(t[e]);super(t,g.ee)}get se(){let t=[];for(let e in this.Ht){let s=this.Ht[e];"object"==typeof s&&t.push(s)}return t}}g.ee=new b;class y extends ${constructor(t){for(let e of t)t.delete(e),t.add($.Jt(e));super(t,y.ee)}get se(){let t=[];for(let e of this.Ht)"object"==typeof e&&t.push(e);return t}}y.ee=new class extends u{pt(...t){return"add"==this.bt?(f.p(this.yt)&&!this.Z.has(t[0])&&(this.Z.add($.Jt(t[0])),e._(this.yt)),this.wt):super.pt.apply(this,t)}};class m extends ${constructor(t){for(let[e,s]of t)t.set(e,$.Jt(s));super(t,m.ee)}get se(){let t=[];for(let[e,s]of this.Ht)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}m.ee=new class extends u{pt(...t){return"set"==this.bt?(f.p(this.yt)&&!this.Z.has(t[0])&&(this.Z.set(t[0],$.Jt(t[1])),e._(this.yt)),this.wt):super.pt.apply(this,t)}};class w extends p{constructor(t,e){super(t,e),this.ie=e.gt,this.Qt.active&&this.k()}T(){let t=this.ie.apply(this.at);t!=this.re&&(this.re=t,e._(this))}te(){return this.Zt()}Zt(){return this.Wt(),this.re}Yt(){return this.re}}class j extends p{constructor(t,e){super(t,e),Object.defineProperty(t,e.lt,j.ne(e.lt)),this.Qt.renderer||this.At()}static ne(t){return j.oe[t]=j.oe[t]||{get(){return h.get(this).dt(t).Xt()},set(e){h.get(this).dt(t).he(e)}}}static ce(t){if(null!=t&&"object"==typeof t)if($.Kt(t)){if(!k.v(t[d])){k.ce(t[d]);for(let e of t[d].se)j.ce(e)}}else if(c.et(t,o))for(let e of h.get(t).$t)k.v(e)||(k.ce(e),j.ce(e.ue))}Tt(){this.Qt.renderer&&super.Tt()}te(){return this.ae}Zt(){return this.Qt.renderer&&this.Wt(),this.ue}Yt(){return this.ue}he(t){if(this.Et)this.ue=t;else if(e.p(this)&&t!==this.ae){if(this.Qt.validator&&!this.Qt.validator.apply(this.at,[t]))return r.S.hook.write(this.l);this.ae=$.Jt(t),this.Qt.renderer?this.k():this._(this.ae)}}T(){k.M({j:!0,le:new Set});try{j.ce(this.ae);let t=this.Qt.renderer.apply(this.at,[this.ae]);t!==this.ue&&this._($.Jt(t))}finally{k.H()}}_(t){this.ue=t,e._(this)}Vt(){delete this.ae,delete this.Qt,super.Vt()}}j.oe={};class v extends p{constructor(t,e){super(t,e),this.pt=e.gt}get Ut(){return{active:!0}}te(){return()=>(this.k(),this.fe)}Zt(){return()=>(this.Wt(),this.fe)}Yt(){return()=>this.fe}T(){return this.fe=this.pt.apply(this.at),e._(this),this.fe}}class S extends ${constructor(t){for(let e in t)t[e]=$.Jt(t[e]);super(t,S.ee)}get se(){let t=[];for(let e of this.Ht)"object"==typeof e&&t.push(e);return this.Ht}}S.ee=new class extends b{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&f.jt(t[d]),Reflect.get(t,e,s)}};const x={shrewd:n.it,symbol:o,commit:r.D,construct:r.Y,terminate:r.B,hook:{default:s,vue:i},option:r.S};"undefined"!=typeof window&&window.Vue&&(r.S.hook=new i);class O extends t{get ot(){return{lt:this.h,vt:this.h,ft:w,gt:this.i.get,S:this.o}}ht(){var t=this.i,e=this.h;return t.get=function(){return h.get(this).dt(e).Xt()},t}}class _ extends t{get ot(){return{lt:this.h,vt:this.h,ft:v,gt:this.i.value,S:this.o}}ht(){let t=this.i,e=this.h;return delete t.value,delete t.writable,t.get=function(){return h.get(this).dt(e).Xt()},t}}class k{static M(t){k.de.push(k.Rt),k.Rt=Object.assign({},k.Rt,t)}static H(){k.Rt=k.de.pop()}static get O(){return k.Rt.O}static get g(){return k.Rt.g}static get j(){return k.Rt.j}static get Z(){return k.Rt.Z}static v(t){return k.Rt.le.has(t)}static ce(t){k.Rt.le.add(t)}}k.Rt={O:!1,g:!1,j:!1,Z:null,le:new Set},k.de=[];const R=Symbol("Shrewd Decorators");return x});
//# sourceMappingURL=shrewd.min.js.map
