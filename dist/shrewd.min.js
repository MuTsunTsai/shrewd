/**
 * shrewd v0.0.0-beta.11
 * (c) 2019 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,function(){"use strict";class t{static t(){S.s({i:!0});for(let e of t.o)a.h(e);a.u(),t.o.clear(),S.l();for(let e of t.$)e.p();t.$.clear()}static g(){t.t(),t.m=!1}static j(e){t.o.delete(e)}static v(e){if(e.S||t.o.add(e),!t.m){Promise.resolve().then(t.g),t.m=!0}}static O(t,...e){S.s({_:!0,i:!1,C:!1,R:null});let s=new t(...e);return S.l(),s}static p(e){o.A(e,i)&&t.$.add(e[i])}}t.o=new Set,t.$=new Set,t.m=!1;const e=Symbol("Shrewd Decorators");class s{static get(t){if(o.A(t,e))return t[e];{let s=[];return o.k(t,e,s),s}}static P(t,e,i){if(void 0===e)return(e,i)=>s.M(e,i,t);if("string"==typeof e){let r=i||Object.getOwnPropertyDescriptor(t,e);if(!r)return s.M(t,e);if(r.get&&!r.set)return s.D(t,e,r);if("function"==typeof r.value)return s.W(t,e,r)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. `+"Decorated member must be one of the following: a field, a readonly get accessor, or a method.")}static M(t,e,i){Object.getOwnPropertyDescriptor(t,e)?console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. `+"Decorated property is not a field."):(s.get(t).push({q:e,F:t.constructor.name+"."+e.toString(),H:w,I:i}),Object.defineProperty(t,e,{get(){return r.get(this),this[e]},set(t){r.get(this),this[e]=t}}))}static D(t,e,i){let n=t.constructor.name+"."+e.toString();return s.get(t).push({q:n,F:n,H:m,T:i.get}),i.get=function(){return r.get(this).G(n).B()},i}static W(t,e,i){let n=t.constructor.name+"."+e.toString();return s.get(t).push({q:n,F:n,H:y,T:i.value}),delete i.value,delete i.writable,i.get=function(){return r.get(this).G(n).B()},i}}const i=Symbol("ShrewdObject");class r{constructor(t){this.J=!1,this.K=new Map,this.L=o.k(t,i,this);let s=Object.getPrototypeOf(this.L);for(;s;){if(o.A(s,e)){let t=s[e];for(let e of t)this.K.set(e.q,new e.H(this.L,e))}s=Object.getPrototypeOf(s)}}static get(t){return o.A(t,i)?t[i]:new r(t)}p(){if(!this.J){for(let t of this.K.values())t.p();this.J=!0}}G(t){return this.K.get(t)}get N(){let t=[];for(let e of this.K.values())e instanceof w&&t.push(e);return t}}class n{constructor(){this.U=new Set}static V(t){return!(!S._&&t.X)||(w.S&&!w.Y(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),!1):!(!w.S&&S.i)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty. For constructing new Shrewd objects, use Shrewd.construct() method."),!1))}static Z(t){for(let e of t.U)e.tt()}et(t){this.U.add(t)}st(t){this.U.delete(t)}get X(){return this.U.size>0}get it(){return this.U.values()}}class o{static A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static k(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class c{isExtensible(t){return!1}}var h;!function(t){t[t.rt=0]="$outdated",t[t.nt=1]="$updated",t[t.ot=2]="$pending"}(h||(h={}));class a extends n{constructor(t){super(),this.ct=new Set,this.ht=!1,this.at=h.rt,this.J=!1,this.ut=t}static u(){for(let t of a.lt)t.at==h.ot&&t.ft();a.lt.clear()}static dt(t){if(t instanceof a&&t.J)return;let e=S.R;e&&e!=t&&!e.J&&e.ct.add(t)}static $t(e){if(e instanceof a&&!e.bt&&!e.J){let s=new Set(e.ct);e.pt(),t.j(e),e.gt();for(let t of s)a.$t(t)}}static h(e){S.s({_:!1,R:e,C:S.C||e.bt}),e.ht=!0,t.j(e);let s=new Set(e.ct);e.pt();let i=e.h();if(S.C&&e.ft(),!e.J)for(let t of e.ct)s.delete(t),S.C&&t.et(e);for(let t of s)a.$t(t);return e.ht=!1,S.l(),i}get S(){return this.ht}tt(){this.wt(),this.gt(),t.v(this)}p(){if(!this.J){this.pt();for(let t of this.it)t.ct.delete(this),this.st(t);this.ft(),this.J=!0,this.ht=!1}}wt(){if(this.at==h.nt){this.at=h.ot,a.lt.add(this);for(let t of this.it)t.wt()}}yt(){if(this.S){let t=a.jt.indexOf(this),e=[this,...a.jt.slice(t+1),this];e.forEach(t=>t.p());let s=e.map(t=>t.ut).join(" => ");console.warn("Circular dependency detected: "+s+"\nAll these observers will be terminated.")}if(this.at!=h.nt){a.jt.push(this);for(let t of this.ct)t instanceof a&&(t.ht?a.h(this):t.at!=h.nt&&t.yt());this.at==h.rt?a.h(this):(a.lt.delete(this),this.ft()),a.jt.pop()}}ft(){this.at=h.nt}gt(){this.at=h.rt}get vt(){return this.at==h.ot}get bt(){return this.X}pt(){for(let t of this.ct)t.st(this);this.ct.clear()}get St(){return this.J}}a.lt=new Set,a.jt=[];const u=Symbol("Observable Helper");class l extends n{constructor(t,e){super(),this.xt=o.k(t,u,this),this.Ot=new Proxy(t,e),l._t.set(t,this.Ot)}static Ct(t){if("object"!=typeof t)return t;if(l._t.has(t))return l._t.get(t);if(!l.Rt(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new j(t).At;break;case Set.prototype:t=new p(t).At;break;case Map.prototype:t=new g(t).At;break;case Object.prototype:t=new b(t).At}return t}static Rt(t){return"object"==typeof t&&o.A(t,u)}get At(){return this.Ot}}l._t=new WeakMap;class f extends c{get(t,e,s){let i=t[u],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.kt.bind({Pt:e,R:t,T:r.bind(t),Mt:i,Dt:s})),"size"==e&&a.dt(t[u]),r}kt(...t){switch(this.Pt){case"clear":return void(a.V(this.Mt)&&this.R.size>0&&(this.R.clear(),n.Z(this.Mt)));case"delete":return void(a.V(this.Mt)&&this.R.has(t[0])&&(this.R.delete(t[0]),n.Z(this.Mt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":a.dt(this.Mt);default:return this.T(...t)}}}class d extends a{constructor(t,e){super(e.F),this.L=t}}class $ extends c{has(t,e){return a.dt(t[u]),Reflect.has(t,e)}get(t,e,s){return a.dt(t[u]),Reflect.get(t,e,s)}set(t,e,s,i){let r=t[u];if(n.V(r)){return s!==Reflect.get(t,e,i)&&(Reflect.set(t,e,l.Ct(s),i),n.Z(r)),!0}return!0}deleteProperty(t,e){let s=t[u];if(n.V(s)){let i=Reflect.deleteProperty(t,e);return i&&n.Z(s),i}return!0}}class b extends l{constructor(t){for(let e in t)t[e]=l.Ct(t[e]);super(t,b.Et)}get Wt(){let t=[];for(let e in this.xt){let s=this.xt[e];"object"==typeof s&&t.push(s)}return t}}b.Et=new $;class p extends l{constructor(t){for(let e of t)t.delete(e),t.add(l.Ct(e));super(t,p.Et)}get Wt(){let t=[];for(let e of this.xt)"object"==typeof e&&t.push(e);return t}}p.Et=new class extends f{kt(...t){return"add"==this.Pt?(a.V(this.Mt)&&!this.R.has(t[0])&&(this.R.add(l.Ct(t[0])),n.Z(this.Mt)),this.Dt):super.kt.apply(this,t)}};class g extends l{constructor(t){for(let[e,s]of t)t.set(e,l.Ct(s));super(t,g.Et)}get Wt(){let t=[];for(let[e,s]of this.xt)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}g.Et=new class extends f{kt(...t){return"set"==this.Pt?(a.V(this.Mt)&&!this.R.has(t[0])&&(this.R.set(t[0],l.Ct(t[1])),n.Z(this.Mt)),this.Dt):super.kt.apply(this,t)}};class m extends d{constructor(t,e){super(t,e),this.qt=e.T}h(){let t=this.qt.apply(this.L);t!=this.Ft&&(this.Ft=t,n.Z(this))}B(){return this.St?this.Ft=this.qt.apply(this.L):(a.dt(this),this.yt()),this.Ft}}class w extends d{constructor(t,e){super(t,e),this.Ht=e.I||{},Object.defineProperty(t,e.q,w.zt(e.q)),this.Ht.renderer||this.ft()}static zt(t){return w.It[t]=w.It[t]||{get(){return r.get(this).G(t).B()},set(e){r.get(this).G(t).Tt(e)}}}static get S(){return w.ht}static Bt(t){if("object"==typeof t)if(l.Rt(t)){if(!w.Gt.has(t[u])){w.Gt.add(t[u]);for(let e of t[u].Wt)w.Bt(e)}}else if(o.A(t,i))for(let e of r.get(t).N)w.Gt.has(e)||(w.Gt.add(e),w.Bt(e.Jt))}static Y(t){return w.Gt.has(t)}gt(){this.Ht.renderer&&super.gt()}B(){return this.St||(a.dt(this),this.Ht.renderer&&this.yt()),this.Jt}Tt(t){if(this.St)this.Jt=t;else if(n.V(this)&&t!=this.Kt){if(this.Ht.validator&&!this.Ht.validator.apply(this.L,[t]))return;this.Kt=l.Ct(t),this.Ht.renderer?a.h(this):this.Z(this.Kt)}}h(){w.ht=!0,w.Bt(this.Kt);let t=this.Ht.renderer.apply(this.L,[this.Kt]);w.Gt.clear(),w.ht=!1,t!==this.Jt&&this.Z(l.Ct(t))}Z(t){this.Jt=t,n.Z(this)}p(){this.St||(delete this.Kt,delete this.Ht,super.p())}}w.It={},w.ht=!1,w.Gt=new Set;class y extends d{constructor(t,e){super(t,e),this.kt=e.T}get bt(){return!0}B(){return this.St?()=>this.kt.apply(this.L):(a.dt(this),S.i||this.vt?()=>(this.yt(),this.Lt):()=>a.h(this))}h(){return this.Lt=this.kt.apply(this.L),n.Z(this),this.Lt}}class j extends l{constructor(t){for(let e in t)t[e]=l.Ct(t[e]);super(t,j.Et)}get Wt(){let t=[];for(let e of this.xt)"object"==typeof e&&t.push(e);return this.xt}}j.Et=new class extends ${get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&a.dt(t[u]),Reflect.get(t,e,s)}};const v={shrewd:s.P,decorate:null,commit:t.t,construct:t.O,terminate:t.p};class S{static s(t){S.Nt.push(S.at),S.at=Object.assign({},S.at,t)}static l(){S.at=S.Nt.pop()}static get i(){return S.at.i}static get _(){return S.at._}static get C(){return S.at.C}static get R(){return S.at.R}}return S.at={i:!1,_:!1,C:!1,R:null},S.Nt=[],v});
//# sourceMappingURL=shrewd.min.js.map
