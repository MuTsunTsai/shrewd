/**
 * shrewd v0.0.0-beta.11
 * (c) 2019 Mu-Tsun Tsai
 * Released under the MIT License.
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Shrewd=e()}(this,function(){"use strict";class t{static t(){x.s({i:!0});for(let e of t.o)a.h(e);a.u(),t.o.clear(),x.l();for(let e of t.$)e.p();t.$.clear()}static g(){t.t(),t.m=!1}static j(e){t.o.delete(e)}static v(e){if(e.S||t.o.add(e),!t.m){Promise.resolve().then(t.g),t.m=!0}}static O(t,...e){x.s({_:!0,i:!1,C:!1,R:null});let s=new t(...e);return x.l(),s}static p(e){o.k(e,i)&&t.$.add(e[i])}}t.o=new Set,t.$=new Set,t.m=!1;const e=Symbol("Shrewd Decorators");class s{static get(t){if(o.k(t,e))return t[e];{let s=[];return o.A(t,e,s),s}}static P(t,e,i,r){if(void 0===e)return(e,i,r)=>s.P(e,i,r,t);if("string"==typeof e){let n=i||Object.getOwnPropertyDescriptor(t,e);if(!n)return s.W(t,e,r);if(n.get&&!n.set)return s.M(t,e,n);if("function"==typeof n.value)return s.D(t,e,n,r)}console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. `+"Decorated member must be one of the following: a field, a readonly get accessor, or a method.")}static W(t,e,i){Object.getOwnPropertyDescriptor(t,e)?console.warn(`Setup error at ${t.constructor.name}[${e.toString()}]. `+"Decorated property is not a field."):(s.get(t).push({q:e,F:t.constructor.name+"."+e.toString(),H:y,I:i}),Object.defineProperty(t,e,{get(){return r.get(this),this[e]},set(t){r.get(this),this[e]=t}}))}static M(t,e,i){let n=t.constructor.name+"."+e.toString();return s.get(t).push({q:n,F:n,H:w,T:i.get}),i.get=function(){return r.get(this).G(n).B()},i}static D(t,e,i,n){let o=t.constructor.name+"."+e.toString();return s.get(t).push({q:o,F:o,H:j,T:i.value,I:n}),delete i.value,delete i.writable,i.get=function(){return r.get(this).G(o).B()},i}}const i=Symbol("ShrewdObject");class r{constructor(t){this.J=!1,this.K=new Map,this.L=o.A(t,i,this);let s=Object.getPrototypeOf(this.L);for(;s;){if(o.k(s,e)){let t=s[e];for(let e of t)this.setup(e)}s=Object.getPrototypeOf(s)}}static get(t){return o.k(t,i)?t[i]:new r(t)}setup(t){this.K.set(t.q,new t.H(this.L,t))}p(){if(!this.J){for(let t of this.K.values())t.p();this.J=!0}}G(t){return this.K.get(t)}get N(){let t=[];for(let e of this.K.values())e instanceof y&&t.push(e);return t}}class n{constructor(){this.U=new Set}static V(t){return!(!x._&&t.X)||(y.S&&!y.Y(t)?(console.warn("Inside a renderer function, only the objects owned by the ObservableProperty can be written."),!1):!(!y.S&&x.i)||(console.warn("Writing into Observables is not allowed inside a ComputedProperty or a ReactiveMethod. For self-correcting behavior, use the renderer option of the ObservableProperty. For constructing new Shrewd objects, use Shrewd.construct() method."),!1))}static Z(t){for(let e of t.U)e.tt()}et(t){this.U.add(t)}st(t){this.U.delete(t)}get X(){return this.U.size>0}get it(){return this.U.values()}}class o{static k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}static A(t,e,s){return Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!1,value:s}),t}}class h{isExtensible(t){return!1}}class c{static install(t){t.mixin({mounted(){new r(this.rt).setup({q:"Watcher.getter",F:"Watcher.getter",H:j,T:this.rt.getter}),Object.defineProperty(this.rt,"getter",{get:function(){return r.get(this).G("Watcher.getter").B()}}),this.rt.getter()}})}}var u;"undefined"!=typeof window&&window.Vue&&window.Vue.use(c),function(t){t[t.nt=0]="$outdated",t[t.ot=1]="$updated",t[t.ht=2]="$pending"}(u||(u={}));class a extends n{constructor(t){super(),this.ct=new Set,this.ut=!1,this.at=u.nt,this.J=!1,this.lt=t}static u(){for(let t of a.ft)t.at==u.ht&&t.dt();a.ft.clear()}static $t(t){if(t instanceof a&&t.J)return;let e=x.R;e&&e!=t&&!e.J&&e.ct.add(t)}static bt(e){if(e instanceof a&&!e.pt&&!e.J){let s=new Set(e.ct);e.gt(),t.j(e),e.wt();for(let t of s)a.bt(t)}}static h(e){x.s({_:!1,R:e,C:x.C||e.pt}),e.ut=!0,t.j(e);let s=new Set(e.ct);e.gt();let i=e.h();if(x.C&&e.dt(),!e.J)for(let t of e.ct)s.delete(t),x.C&&t.et(e);for(let t of s)a.bt(t);return e.ut=!1,x.l(),i}get S(){return this.ut}tt(){this.yt(),this.wt(),t.v(this)}p(){if(!this.J){this.gt();for(let t of this.it)t.ct.delete(this),this.st(t);this.dt(),this.J=!0,this.ut=!1}}yt(){if(this.at==u.ot){this.at=u.ht,a.ft.add(this);for(let t of this.it)t.yt()}}jt(){if(this.S){let t=a.vt.indexOf(this),e=[this,...a.vt.slice(t+1),this];e.forEach(t=>t.p());let s=e.map(t=>t.lt).join(" => ");console.warn("Circular dependency detected: "+s+"\nAll these observers will be terminated.")}if(this.at!=u.ot){a.vt.push(this);for(let t of this.ct)t instanceof a&&(t.ut?a.h(this):t.at!=u.ot&&t.jt());this.at==u.nt?a.h(this):(a.ft.delete(this),this.dt()),a.vt.pop()}}dt(){this.at=u.ot}wt(){this.at=u.nt}get St(){return this.at==u.ht}get pt(){return this.X}gt(){for(let t of this.ct)t.st(this);this.ct.clear()}get xt(){return this.J}}a.ft=new Set,a.vt=[];const l=Symbol("Observable Helper");class f extends n{constructor(t,e){super(),this.Ot=o.A(t,l,this),this._t=new Proxy(t,e),f.Ct.set(t,this._t)}static Rt(t){if(null==t||"object"!=typeof t)return t;if(f.Ct.has(t))return f.Ct.get(t);if(!f.kt(t))switch(Object.getPrototypeOf(t)){case Array.prototype:t=new v(t).At;break;case Set.prototype:t=new g(t).At;break;case Map.prototype:t=new m(t).At;break;case Object.prototype:t=new p(t).At}return t}static kt(t){return null!=t&&"object"==typeof t&&o.k(t,l)}get At(){return this._t}}f.Ct=new WeakMap;class d extends h{get(t,e,s){let i=t[l],r=Reflect.get(t,e);return"function"==typeof r&&(r=this.Pt.bind({Wt:e,R:t,T:r.bind(t),Mt:i,Dt:s})),"size"==e&&a.$t(t[l]),r}Pt(...t){switch(this.Wt){case"clear":return void(a.V(this.Mt)&&this.R.size>0&&(this.R.clear(),n.Z(this.Mt)));case"delete":return void(a.V(this.Mt)&&this.R.has(t[0])&&(this.R.delete(t[0]),n.Z(this.Mt)));case Symbol.iterator:case"entries":case"forEach":case"has":case"keys":case"values":a.$t(this.Mt);default:return this.T(...t)}}}class $ extends a{constructor(t,e){super(e.F),this.L=t}}class b extends h{has(t,e){return a.$t(t[l]),Reflect.has(t,e)}get(t,e,s){return a.$t(t[l]),Reflect.get(t,e,s)}set(t,e,s,i){let r=t[l];if(n.V(r)){return s!==Reflect.get(t,e,i)&&(Reflect.set(t,e,f.Rt(s),i),n.Z(r)),!0}return!0}deleteProperty(t,e){let s=t[l];if(n.V(s)){let i=Reflect.deleteProperty(t,e);return i&&n.Z(s),i}return!0}}class p extends f{constructor(t){for(let e in t)t[e]=f.Rt(t[e]);super(t,p.Et)}get qt(){let t=[];for(let e in this.Ot){let s=this.Ot[e];"object"==typeof s&&t.push(s)}return t}}p.Et=new b;class g extends f{constructor(t){for(let e of t)t.delete(e),t.add(f.Rt(e));super(t,g.Et)}get qt(){let t=[];for(let e of this.Ot)"object"==typeof e&&t.push(e);return t}}g.Et=new class extends d{Pt(...t){return"add"==this.Wt?(a.V(this.Mt)&&!this.R.has(t[0])&&(this.R.add(f.Rt(t[0])),n.Z(this.Mt)),this.Dt):super.Pt.apply(this,t)}};class m extends f{constructor(t){for(let[e,s]of t)t.set(e,f.Rt(s));super(t,m.Et)}get qt(){let t=[];for(let[e,s]of this.Ot)"object"==typeof e&&t.push(e),"object"==typeof s&&t.push(s);return t}}m.Et=new class extends d{Pt(...t){return"set"==this.Wt?(a.V(this.Mt)&&!this.R.has(t[0])&&(this.R.set(t[0],f.Rt(t[1])),n.Z(this.Mt)),this.Dt):super.Pt.apply(this,t)}};class w extends ${constructor(t,e){super(t,e),this.Ft=e.T}h(){let t=this.Ft.apply(this.L);t!=this.Ht&&(this.Ht=t,n.Z(this))}B(){return this.xt?this.Ht=this.Ft.apply(this.L):(a.$t(this),this.jt()),this.Ht}}class y extends ${constructor(t,e){super(t,e),this.zt=e.I||{},Object.defineProperty(t,e.q,y.It(e.q)),this.zt.renderer||this.dt()}static It(t){return y.Tt[t]=y.Tt[t]||{get(){return r.get(this).G(t).B()},set(e){r.get(this).G(t).Bt(e)}}}static get S(){return y.ut}static Gt(t){if(null!=t&&"object"==typeof t)if(f.kt(t)){if(!y.Jt.has(t[l])){y.Jt.add(t[l]);for(let e of t[l].qt)y.Gt(e)}}else if(o.k(t,i))for(let e of r.get(t).N)y.Jt.has(e)||(y.Jt.add(e),y.Gt(e.Kt))}static Y(t){return y.Jt.has(t)}wt(){this.zt.renderer&&super.wt()}B(){return this.xt||(a.$t(this),this.zt.renderer&&this.jt()),this.Kt}Bt(t){if(this.xt)this.Kt=t;else if(n.V(this)&&t!=this.Lt){if(this.zt.validator&&!this.zt.validator.apply(this.L,[t]))return;this.Lt=f.Rt(t),this.zt.renderer?a.h(this):this.Z(this.Lt)}}h(){y.ut=!0,y.Gt(this.Lt);let t=this.zt.renderer.apply(this.L,[this.Lt]);y.Jt.clear(),y.ut=!1,t!==this.Kt&&this.Z(f.Rt(t))}Z(t){this.Kt=t,n.Z(this)}p(){this.xt||(delete this.Lt,delete this.zt,super.p())}}y.Tt={},y.ut=!1,y.Jt=new Set;class j extends ${constructor(t,e){super(t,e),this.Pt=e.T,this.zt=e.I||{}}get pt(){return!0}B(){return this.xt?()=>this.Pt.apply(this.L):(a.$t(this),this.zt.lazy?()=>(this.tt(),this.Nt):x.i||this.St?()=>(this.jt(),this.Nt):()=>a.h(this))}h(){return this.Nt=this.Pt.apply(this.L),n.Z(this),this.Nt}}class v extends f{constructor(t){for(let e in t)t[e]=f.Rt(t[e]);super(t,v.Et)}get qt(){let t=[];for(let e of this.Ot)"object"==typeof e&&t.push(e);return this.Ot}}v.Et=new class extends b{get(t,e,s){return("length"==e||"symbol"==typeof e||"number"==typeof e||"string"==typeof e&&e.match(/^\d+$/))&&a.$t(t[l]),Reflect.get(t,e,s)}};const S={shrewd:s.P,decorate:null,commit:t.t,construct:t.O,terminate:t.p,plugin:{vue:c}};class x{static s(t){x.Qt.push(x.at),x.at=Object.assign({},x.at,t)}static l(){x.at=x.Qt.pop()}static get i(){return x.at.i}static get _(){return x.at._}static get C(){return x.at.C}static get R(){return x.at.R}}return x.at={i:!1,_:!1,C:!1,R:null},x.Qt=[],S});
//# sourceMappingURL=shrewd.min.js.map
